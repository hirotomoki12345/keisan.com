<!DOCTYPE html>
<html>
<head>
  <title>Save Data to Google Sheet</title>
</head>
<body>

<form id="dataForm">
  <label for="name">Name:</label>
  <input type="text" id="name" name="name" required><br>

  <label for="sheetname">Sheet Name:</label>
  <input type="text" id="sheetname" name="sheetname" required><br>

  <label for="text">Text:</label>
  <textarea id="text" name="text" required></textarea><br>

  <button type="button" onclick="getLocation()">Get Location</button>
  <input type="hidden" id="location" name="location"><br>

  <input type="hidden" id="ip" name="ip">

  <button type="button" onclick="submitForm()">Submit</button>
</form>

<script>
function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else {
    alert("Geolocation is not supported by this browser.");
  }
}

function showPosition(position) {
  document.getElementById("location").value = position.coords.latitude + "," + position.coords.longitude;
}

function getIP() {
  fetch('https://ipinfo.io?callback')
    .then(res => res.json())
    .then(json => {
      document.getElementById("ip").value = json.ip;
    })
    .catch(error => console.error('Error fetching IP:', error));
}

function submitForm() {
  // Set IP before submitting
  getIP();
  
  // Submit the form
  document.getElementById("dataForm").submit();
}
</script>

</body>
</html>
